<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Panel - West Central Movies</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background-color: #1a1a2e;
            color: #f5f5f5;
            line-height: 1.6;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
        }
        
        /* Header Styles */
        header {
            background: linear-gradient(to right, #0f0c29, #302b63, #24243e);
            padding: 20px 0;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.5);
        }
        
        .header-content {
            display: flex;
            align-items: center;
            justify-content: space-between;
        }
        
        .logo {
            display: flex;
            align-items: center;
        }
        
        .logo i {
            font-size: 28px;
            color: #ffcc00;
            margin-right: 10px;
        }
        
        .logo h1 {
            font-size: 24px;
            font-weight: 700;
        }
        
        .logo span {
            color: #ffcc00;
        }
        
        .admin-actions {
            display: flex;
            gap: 15px;
        }
        
        .admin-btn {
            padding: 10px 20px;
            background: rgba(255, 255, 255, 0.1);
            color: #fff;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .admin-btn:hover {
            background: #ffcc00;
            color: #0a0a1a;
        }
        
        /* Main Content */
        .main-content {
            display: flex;
            margin-top: 30px;
            gap: 30px;
        }
        
        /* Sidebar */
        .sidebar {
            width: 250px;
            background: #16213e;
            border-radius: 10px;
            padding: 20px;
            height: fit-content;
        }
        
        .sidebar-title {
            color: #ffcc00;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .sidebar-menu {
            list-style: none;
        }
        
        .sidebar-menu li {
            margin-bottom: 10px;
        }
        
        .sidebar-menu a {
            display: block;
            padding: 12px 15px;
            color: #f5f5f5;
            text-decoration: none;
            border-radius: 5px;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .sidebar-menu a:hover, 
        .sidebar-menu a.active {
            background: rgba(255, 204, 0, 0.2);
            color: #ffcc00;
        }
        
        /* Admin Content */
        .admin-content {
            flex: 1;
            background: #16213e;
            border-radius: 10px;
            padding: 25px;
            margin-bottom: 40px;
        }
        
        .content-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
            padding-bottom: 15px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .content-header h2 {
            color: #ffcc00;
        }
        
        /* Form Styles */
        .form-section {
            margin-bottom: 30px;
        }
        
        .form-section-title {
            color: #ffcc00;
            margin-bottom: 15px;
            padding-bottom: 8px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .form-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
        }
        
        .form-group input,
        .form-group select,
        .form-group textarea {
            width: 100%;
            padding: 12px 15px;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 5px;
            color: #fff;
            font-size: 16px;
        }
        
        .form-group textarea {
            min-height: 120px;
            resize: vertical;
        }
        
        .form-group input[type="file"] {
            padding: 10px;
        }
        
        .btn-primary {
            background: #ffcc00;
            color: #0a0a1a;
            border: none;
            padding: 12px 25px;
            border-radius: 5px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }
        
        .btn-primary:hover {
            background: #ffdd33;
            transform: translateY(-2px);
        }
        
        /* Movie List */
        .movie-list {
            margin-top: 30px;
        }
        
        .movie-item {
            display: flex;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 8px;
            overflow: hidden;
            margin-bottom: 20px;
        }
        
        .movie-poster {
            width: 120px;
            height: 160px;
            object-fit: cover;
        }
        
        .movie-details {
            padding: 15px;
            flex: 1;
        }
        
        .movie-title {
            font-size: 18px;
            color: #ffcc00;
            margin-bottom: 8px;
        }
        
        .movie-info {
            color: #aaa;
            font-size: 14px;
            margin-bottom: 12px;
        }
        
        .movie-actions {
            display: flex;
            gap: 10px;
        }
        
        .action-btn {
            padding: 6px 12px;
            border-radius: 4px;
            font-size: 14px;
            cursor: pointer;
            border: none;
            display: flex;
            align-items: center;
            gap: 5px;
        }
        
        .edit-btn {
            background: rgba(255, 204, 0, 0.2);
            color: #ffcc00;
        }
        
        .delete-btn {
            background: rgba(255, 0, 0, 0.2);
            color: #ff6b6b;
        }
        
        /* Dashboard Cards */
        .stats-cards {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .stat-card {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 10px;
            padding: 20px;
            text-align: center;
        }
        
        .stat-card i {
            font-size: 32px;
            color: #ffcc00;
            margin-bottom: 15px;
        }
        
        .stat-card h3 {
            font-size: 32px;
            margin-bottom: 5px;
        }
        
        .stat-card p {
            color: #aaa;
        }
        
        /* Footer */
        footer {
            background: #0c0c1e;
            padding: 30px 0;
            margin-top: 40px;
            text-align: center;
        }
        
        .footer-content {
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        
        .footer-logo {
            font-size: 22px;
            font-weight: 700;
            margin-bottom: 15px;
        }
        
        .footer-logo span {
            color: #ffcc00;
        }
        
        .copyright {
            color: #aaa;
            font-size: 14px;
        }
        
        /* Status Messages */
        .status-message {
            padding: 12px 15px;
            border-radius: 5px;
            margin: 15px 0;
            display: none;
        }
        
        .status-success {
            background: rgba(46, 204, 113, 0.2);
            color: #2ecc71;
            border: 1px solid #2ecc71;
        }
        
        .status-error {
            background: rgba(231, 76, 60, 0.2);
            color: #e74c3c;
            border: 1px solid #e74c3c;
        }
        
        /* Responsive Design */
        @media (max-width: 900px) {
            .main-content {
                flex-direction: column;
            }
            
            .sidebar {
                width: 100%;
            }
            
            .admin-actions {
                flex-wrap: wrap;
                justify-content: center;
                margin-top: 15px;
            }
            
            .header-content {
                flex-direction: column;
            }
        }
        
        @media (max-width: 600px) {
            .form-grid {
                grid-template-columns: 1fr;
            }
            
            .movie-item {
                flex-direction: column;
            }
            
            .movie-poster {
                width: 100%;
                height: 200px;
            }
            
            .stats-cards {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <!-- Header Section -->
    <header>
        <div class="container">
            <div class="header-content">
                <div class="logo">
                    <i class="fas fa-film"></i>
                    <h1>West Central <span>Movies</span> Admin</h1>
                </div>
                <div class="admin-actions">
                    <button class="admin-btn" onclick="exportData()">
                        <i class="fas fa-file-export"></i> Export Data
                    </button>
                    <button class="admin-btn" onclick="importData()">
                        <i class="fas fa-file-import"></i> Import Data
                    </button>
                    <button class="admin-btn" onclick="loadMovies()">
                        <i class="fas fa-sync-alt"></i> Refresh
                    </button>
                    <button class="admin-btn" onclick="testConnection()">
                        <i class="fas fa-plug"></i> Test Connection
                    </button>
                </div>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <div class="container">
        <div class="main-content">
            <!-- Sidebar -->
            <div class="sidebar">
                <h2 class="sidebar-title">Admin Navigation</h2>
                <ul class="sidebar-menu">
                    <li><a href="#" class="active"><i class="fas fa-tachometer-alt"></i> Dashboard</a></li>
                    <li><a href="#" onclick="showSection('movie-management')"><i class="fas fa-play-circle"></i> Now Showing</a></li>
                    <li><a href="#" onclick="showSection('movie-management')"><i class="fas fa-star"></i> New This Week</a></li>
                    <li><a href="#" onclick="showSection('movie-management')"><i class="fas fa-calendar-alt"></i> Coming Soon</a></li>
                    <li><a href="#" onclick="showSection('schedule-management')"><i class="fas fa-clock"></i> Schedules</a></li>
                    <li><a href="#" onclick="showSection('user-management')"><i class="fas fa-users"></i> Users</a></li>
                    <li><a href="#" onclick="showSection('settings')"><i class="fas fa-cog"></i> Settings</a></li>
                </ul>
            </div>

            <!-- Admin Content -->
            <div class="admin-content">
                <div class="content-header">
                    <h2>Movie Management Dashboard</h2>
                    <button class="btn-primary" onclick="saveChanges()">
                        <i class="fas fa-save"></i> Save Changes
                    </button>
                </div>

                <!-- Status Messages -->
                <div id="statusMessage" class="status-message"></div>

                <!-- Stats Cards -->
                <div class="stats-cards">
                    <div class="stat-card">
                        <i class="fas fa-play-circle"></i>
                        <h3 id="nowShowingCount">0</h3>
                        <p>Now Showing</p>
                    </div>
                    <div class="stat-card">
                        <i class="fas fa-star"></i>
                        <h3 id="newThisWeekCount">0</h3>
                        <p>New This Week</p>
                    </div>
                    <div class="stat-card">
                        <i class="fas fa-calendar-alt"></i>
                        <h3 id="comingSoonCount">0</h3>
                        <p>Coming Soon</p>
                    </div>
                    <div class="stat-card">
                        <i class="fas fa-users"></i>
                        <h3 id="totalMoviesCount">0</h3>
                        <p>Total Movies</p>
                    </div>
                </div>

                <!-- Add Movie Form -->
                <div class="form-section" id="movie-management">
                    <h3 class="form-section-title">Add New Movie</h3>
                    <div class="form-grid">
                        <div class="form-group">
                            <label for="movieTitle">Movie Title</label>
                            <input type="text" id="movieTitle" placeholder="Enter movie title">
                        </div>
                        <div class="form-group">
                            <label for="movieCategory">Category</label>
                            <select id="movieCategory">
                                <option value="">Select category</option>
                                <option value="action">Action</option>
                                <option value="comedy">Comedy</option>
                                <option value="drama">Drama</option>
                                <option value="sci-fi">Sci-Fi</option>
                                <option value="horror">Horror</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="movieDuration">Duration (minutes)</label>
                            <input type="number" id="movieDuration" placeholder="Duration in minutes">
                        </div>
                        <div class="form-group">
                            <label for="movieStatus">Status</label>
                            <select id="movieStatus">
                                <option value="">Select status</option>
                                <option value="now-showing">Now Showing</option>
                                <option value="new-this-week">New This Week</option>
                                <option value="coming-soon">Coming Soon</option>
                            </select>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label for="movieDescription">Description</label>
                        <textarea id="movieDescription" placeholder="Enter movie description"></textarea>
                    </div>
                    
                    <div class="form-grid">
                        <div class="form-group">
                            <label for="moviePoster">Movie Poster URL</label>
                            <input type="text" id="moviePoster" placeholder="Enter poster image URL">
                        </div>
                        <div class="form-group">
                            <label for="movieTrailer">Trailer URL</label>
                            <input type="text" id="movieTrailer" placeholder="Enter YouTube trailer URL">
                        </div>
                    </div>
                    
                    <button class="btn-primary" onclick="addMovie()">
                        <i class="fas fa-plus"></i> Add Movie
                    </button>
                </div>

                <!-- Movie List -->
                <div class="form-section">
                    <h3 class="form-section-title">Current Movies</h3>
                    <div class="movie-list" id="movieListContainer">
                        <!-- Movies will be loaded here dynamically -->
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer>
        <div class="container">
            <div class="footer-content">
                <div class="footer-logo">
                    West Central <span>Movies</span> Admin Panel
                </div>
                <p class="copyright">© 2023 West Central Movies. All rights reserved.</p>
            </div>
        </div>
    </footer>

    <!-- Load Supabase JavaScript library -->
    <script src="https://unpkg.com/@supabase/supabase-js@2"></script>
    <script>
        // Initialize Supabase with your credentials
        const supabaseUrl = 'https://atuhpigdnhbicoaxwwxq.supabase.co';
        const supabaseKey = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImF0dWhwaWdkbmhiaWNvYXh3d3hxIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTY2Njk3NDUsImV4cCI6MjA3MjI0NTc0NX0.LiMxZKiJvEGmgs1Et0sWO2lMgoEOrGOjLPtjiwojCwI';
        const supabase = supabase.createClient(supabaseUrl, supabaseKey);
        
        // Status message function
        function showStatus(message, type) {
            const statusElement = document.getElementById('statusMessage');
            statusElement.textContent = message;
            statusElement.className = 'status-message';
            
            if (type === 'success') {
                statusElement.classList.add('status-success');
            } else if (type === 'error') {
                statusElement.classList.add('status-error');
            }
            
            statusElement.style.display = 'block';
            
            // Hide after 5 seconds
            setTimeout(() => {
                statusElement.style.display = 'none';
            }, 5000);
        }
        
        // Test Supabase connection
        async function testConnection() {
            try {
                showStatus('Testing connection to Supabase...', '');
                
                const { data, error } = await supabase
                    .from('movies')
                    .select('*')
                    .limit(1);
                    
                if (error) {
                    showStatus('Connection failed: ' + error.message, 'error');
                    console.error('Supabase error:', error);
                } else {
                    showStatus('Successfully connected to Supabase!', 'success');
                    console.log('Supabase connection test successful');
                }
            } catch (err) {
                showStatus('Connection test error: ' + err.message, 'error');
                console.error('Connection test error:', err);
            }
        }
        
        // Load movies from Supabase
        async function loadMovies() {
            try {
                showStatus('Loading movies...', '');
                
                const { data: movies, error } = await supabase
                    .from('movies')
                    .select('*')
                    .order('title');
                    
                if (error) {
                    showStatus('Error loading movies: ' + error.message, 'error');
                    console.error('Supabase error:', error);
                    return;
                }
                
                // Update counts
                const nowShowing = movies.filter(m => m.status === 'now-showing');
                const newThisWeek = movies.filter(m => m.status === 'new-this-week');
                const comingSoon = movies.filter(m => m.status === 'coming-soon');
                
                document.getElementById('nowShowingCount').textContent = nowShowing.length;
                document.getElementById('newThisWeekCount').textContent = newThisWeek.length;
                document.getElementById('comingSoonCount').textContent = comingSoon.length;
                document.getElementById('totalMoviesCount').textContent = movies.length;
                
                // Render movies
                const movieListContainer = document.getElementById('movieListContainer');
                movieListContainer.innerHTML = '';
                
                if (movies.length === 0) {
                    movieListContainer.innerHTML = '<p>No movies found. Add your first movie above.</p>';
                    return;
                }
                
                movies.forEach(movie => {
                    const movieElement = document.createElement('div');
                    movieElement.className = 'movie-item';
                    movieElement.innerHTML = `
                        <img src="${movie.poster_url || 'https://images.unsplash.com/photo-1594909122845-11baa439b7bf?ixlib=rb-4.0.3&auto=format&fit=crop&w=200&h=300&q=80'}" alt="${movie.title}" class="movie-poster">
                        <div class="movie-details">
                            <h3 class="movie-title">${movie.title}</h3>
                            <p class="movie-info">${movie.genre} • ${movie.duration} • ${movie.status}</p>
                            <p class="movie-description">${movie.description || 'No description available.'}</p>
                            <div class="movie-actions">
                                <button class="action-btn edit-btn" onclick="editMovie(${movie.id})">
                                    <i class="fas fa-edit"></i> Edit
                                </button>
                                <button class="action-btn delete-btn" onclick="deleteMovie(${movie.id})">
                                    <i class="fas fa-trash"></i> Delete
                                </button>
                            </div>
                        </div>
                    `;
                    movieListContainer.appendChild(movieElement);
                });
                
                showStatus(`Loaded ${movies.length} movies successfully`, 'success');
            } catch (err) {
                showStatus('Error loading movies: ' + err.message, 'error');
                console.error('Error loading movies:', err);
            }
        }
        
        // Add a new movie
        async function addMovie() {
            const title = document.getElementById('movieTitle').value;
            const genre = document.getElementById('movieCategory').value;
            const duration = document.getElementById('movieDuration').value;
            const status = document.getElementById('movieStatus').value;
            const description = document.getElementById('movieDescription').value;
            const poster_url = document.getElementById('moviePoster').value;
            const trailer_url = document.getElementById('movieTrailer').value;
            
            if (!title || !genre || !status) {
                showStatus('Please fill in all required fields', 'error');
                return;
            }
            
            try {
                showStatus('Adding movie...', '');
                
                const { data, error } = await supabase
                    .from('movies')
                    .insert([
                        { 
                            title, 
                            genre, 
                            duration: duration ? `${duration} min` : null, 
                            status, 
                            description,
                            poster_url,
                            trailer_url
                        }
                    ]);
                    
                if (error) {
                    showStatus('Error adding movie: ' + error.message, 'error');
                    console.error('Supabase error:', error);
                    return;
                }
                
                // Clear form
                document.getElementById('movieTitle').value = '';
                document.getElementById('movieCategory').value = '';
                document.getElementById('movieDuration').value = '';
                document.getElementById('movieStatus').value = '';
                document.getElementById('movieDescription').value = '';
                document.getElementById('moviePoster').value = '';
                document.getElementById('movieTrailer').value = '';
                
                showStatus('Movie added successfully!', 'success');
                
                // Reload the movie list
                setTimeout(loadMovies, 1000);
            } catch (err) {
                showStatus('Error adding movie: ' + err.message, 'error');
                console.error('Error adding movie:', err);
            }
        }
        
        // Edit movie (placeholder - you would implement this)
        function editMovie(id) {
            showStatus('Edit function would open a form for movie ID: ' + id, '');
            console.log('Edit movie with ID:', id);
        }
        
        // Delete movie
        async function deleteMovie(id) {
            if (!confirm('Are you sure you want to delete this movie?')) {
                return;
            }
            
            try {
                showStatus('Deleting movie...', '');
                
                const { error } = await supabase
                    .from('movies')
                    .delete()
                    .eq('id', id);
                    
                if (error) {
                    showStatus('Error deleting movie: ' + error.message, 'error');
                    console.error('Supabase error:', error);
                    return;
                }
                
                showStatus('Movie deleted successfully!', 'success');
                
                // Reload the movie list
                setTimeout(loadMovies, 1000);
            } catch (err) {
                showStatus('Error deleting movie: ' + err.message, 'error');
                console.error('Error deleting movie:', err);
            }
        }
        
        // Save changes (placeholder - you would implement this based on what needs saving)
        function saveChanges() {
            showStatus('All changes saved successfully!', 'success');
        }
        
        // Export data (placeholder)
        function exportData() {
            showStatus('Export function would download a JSON backup', '');
        }
        
        // Import data (placeholder)
        function importData() {
            showStatus('Import function would upload a JSON backup', '');
        }
        
        // Show section (for navigation)
        function showSection(sectionId) {
            showStatus(`Showing section: ${sectionId}`, '');
            // You would implement logic to show/hide sections here
        }
        
        // Initialize when page loads
        document.addEventListener('DOMContentLoaded', function() {
            console.log('Admin panel initialized');
            testConnection();
            loadMovies();
        });
    </script>
</body>
</html>
